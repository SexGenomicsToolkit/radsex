\hypertarget{process_8cpp}{}\doxysection{/home/romain/work/code/\+Rad\+Sex/src/process.cpp File Reference}
\label{process_8cpp}\index{/home/romain/work/code/RadSex/src/process.cpp@{/home/romain/work/code/RadSex/src/process.cpp}}


Implements functions for the \char`\"{}process\char`\"{} command.  


{\ttfamily \#include \char`\"{}process.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{process_8cpp_a477f1947bea640bb461c265d03dbfba0}\label{process_8cpp_a477f1947bea640bb461c265d03dbfba0}} 
\mbox{\hyperlink{process_8cpp_a477f1947bea640bb461c265d03dbfba0}{K\+S\+E\+Q\+\_\+\+I\+N\+IT}} (gz\+File, gzread)
\begin{DoxyCompactList}\small\item\em Macro to initalize reading sequences from file with Kseq. \end{DoxyCompactList}\item 
std\+::vector$<$ \mbox{\hyperlink{structInputFile}{Input\+File}} $>$ \mbox{\hyperlink{process_8cpp_a3c5a55f10a548cc70126fc2bee03ae2e}{get\+\_\+input\+\_\+files}} (const std\+::string \&input\+\_\+dir\+\_\+path)
\begin{DoxyCompactList}\small\item\em Get input files. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{process_8cpp_aca1db66566c3a841900e42422a31736a}{process}} (\mbox{\hyperlink{structParameters}{Parameters}} \&parameters)
\begin{DoxyCompactList}\small\item\em Main function implementing the \char`\"{}process\char`\"{} command. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{process_8cpp_a8f9898467c5a93ef58a32e78ea0ef208}{file\+\_\+processor}} (std\+::vector$<$ \mbox{\hyperlink{structInputFile}{Input\+File}} $>$ \&input\+\_\+files, std\+::unordered\+\_\+map$<$ std\+::string, std\+::unordered\+\_\+map$<$ std\+::string, uint16\+\_\+t $>$$>$ \&results, std\+::mutex \&results\+\_\+mutex, std\+::mutex \&files\+\_\+mutex)
\begin{DoxyCompactList}\small\item\em File processor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{process_8cpp_a50431291c9f5e8737719d7babc4dd97d}{process\+\_\+file}} (\mbox{\hyperlink{structInputFile}{Input\+File}} \&input\+\_\+file, std\+::unordered\+\_\+map$<$ std\+::string, std\+::unordered\+\_\+map$<$ std\+::string, uint16\+\_\+t $>$$>$ \&results, std\+::mutex \&results\+\_\+mutex)
\begin{DoxyCompactList}\small\item\em Process a single file. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implements functions for the \char`\"{}process\char`\"{} command. 



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{process_8cpp_a8f9898467c5a93ef58a32e78ea0ef208}\label{process_8cpp_a8f9898467c5a93ef58a32e78ea0ef208}} 
\index{process.cpp@{process.cpp}!file\_processor@{file\_processor}}
\index{file\_processor@{file\_processor}!process.cpp@{process.cpp}}
\doxysubsubsection{\texorpdfstring{file\_processor()}{file\_processor()}}
{\footnotesize\ttfamily void file\+\_\+processor (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \mbox{\hyperlink{structInputFile}{Input\+File}} $>$ \&}]{input\+\_\+files,  }\item[{std\+::unordered\+\_\+map$<$ std\+::string, std\+::unordered\+\_\+map$<$ std\+::string, uint16\+\_\+t $>$$>$ \&}]{results,  }\item[{std\+::mutex \&}]{results\+\_\+mutex,  }\item[{std\+::mutex \&}]{files\+\_\+mutex }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



File processor. 

Look for an unprocessed input file in the vector of input files generated by \mbox{\hyperlink{process_8h_a3c5a55f10a548cc70126fc2bee03ae2e}{get\+\_\+input\+\_\+files()}} and process this file.


\begin{DoxyParams}{Parameters}
{\em input\+\_\+files} & Vector of \mbox{\hyperlink{structInputFile}{Input\+File}} generated by \mbox{\hyperlink{process_8h_a3c5a55f10a548cc70126fc2bee03ae2e}{get\+\_\+input\+\_\+files()}} \\
\hline
{\em results} & A map of marker depth for each individual\+: \{\mbox{\hyperlink{classMarker}{Marker}} -\/$>$ \{Individual -\/$>$ depth\}\} \\
\hline
{\em results\+\_\+mutex} & A mutex protecting the marker depth map when writing from \mbox{\hyperlink{process_8h_a50431291c9f5e8737719d7babc4dd97d}{process\+\_\+file()}} \\
\hline
{\em files\+\_\+mutex} & A mutex to lock the \mbox{\hyperlink{structInputFile}{Input\+File}} vector while looking for a file to process \\
\hline
\end{DoxyParams}


Definition at line 173 of file process.\+cpp.



Referenced by process().

\mbox{\Hypertarget{process_8cpp_a3c5a55f10a548cc70126fc2bee03ae2e}\label{process_8cpp_a3c5a55f10a548cc70126fc2bee03ae2e}} 
\index{process.cpp@{process.cpp}!get\_input\_files@{get\_input\_files}}
\index{get\_input\_files@{get\_input\_files}!process.cpp@{process.cpp}}
\doxysubsubsection{\texorpdfstring{get\_input\_files()}{get\_input\_files()}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{structInputFile}{Input\+File}}$>$ get\+\_\+input\+\_\+files (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{input\+\_\+dir\+\_\+path }\end{DoxyParamCaption})}



Get input files. 

Detect all input files in the input directory based on extensions and store file information in a \mbox{\hyperlink{structInputFile}{Input\+File}} vector.


\begin{DoxyParams}{Parameters}
{\em input\+\_\+dir\+\_\+path} & Path to the input directory\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A vector of \mbox{\hyperlink{structInputFile}{Input\+File}} objects, each containing information about an input file 
\end{DoxyReturn}


Definition at line 28 of file process.\+cpp.



Referenced by process().

\mbox{\Hypertarget{process_8cpp_aca1db66566c3a841900e42422a31736a}\label{process_8cpp_aca1db66566c3a841900e42422a31736a}} 
\index{process.cpp@{process.cpp}!process@{process}}
\index{process@{process}!process.cpp@{process.cpp}}
\doxysubsubsection{\texorpdfstring{process()}{process()}}
{\footnotesize\ttfamily void process (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structParameters}{Parameters}} \&}]{parameters }\end{DoxyParamCaption})}



Main function implementing the \char`\"{}process\char`\"{} command. 

Generate a markers depth table from all individual reads files detected in an input directory. The function spans multiple \mbox{\hyperlink{process_8h_a8f9898467c5a93ef58a32e78ea0ef208}{file\+\_\+processor()}} threads to process input files in parallel.


\begin{DoxyParams}{Parameters}
{\em parameters} & A \mbox{\hyperlink{structParameters}{Parameters}} object storing the value of all R\+A\+D\+Sex parameters \\
\hline
\end{DoxyParams}


Definition at line 97 of file process.\+cpp.



Referenced by main(), and parse\+\_\+args().

\mbox{\Hypertarget{process_8cpp_a50431291c9f5e8737719d7babc4dd97d}\label{process_8cpp_a50431291c9f5e8737719d7babc4dd97d}} 
\index{process.cpp@{process.cpp}!process\_file@{process\_file}}
\index{process\_file@{process\_file}!process.cpp@{process.cpp}}
\doxysubsubsection{\texorpdfstring{process\_file()}{process\_file()}}
{\footnotesize\ttfamily void process\+\_\+file (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structInputFile}{Input\+File}} \&}]{input\+\_\+file,  }\item[{std\+::unordered\+\_\+map$<$ std\+::string, std\+::unordered\+\_\+map$<$ std\+::string, uint16\+\_\+t $>$$>$ \&}]{results,  }\item[{std\+::mutex \&}]{results\+\_\+mutex }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Process a single file. 

Read all sequences from an input file with kseq\+\_\+read() and increment the marker depth table accordingly.


\begin{DoxyParams}{Parameters}
{\em input\+\_\+file} & Path to the reads file \\
\hline
{\em results} & A map of marker depth for each individual\+: \{\mbox{\hyperlink{classMarker}{Marker}} -\/$>$ \{Individual -\/$>$ depth\}\} \\
\hline
{\em results\+\_\+mutex} & A mutex protecting the marker depth map when writing from multiple processing threads \\
\hline
\end{DoxyParams}


Definition at line 213 of file process.\+cpp.



Referenced by file\+\_\+processor().

